<!DOCTYPE html>
<html lang="en">
<head>
  <!-- content-Type -->
<meta charset="utf-8">


<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="language" content="en">
<meta name="robots" content="all">


<meta content="yes" name="apple-mobile-web-app-capable">
<meta content="black" name="apple-mobile-web-app-status-bar-style">
<meta content="telephone=no" name="format-detection">
<meta content="email=no" name="format-detection">


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






<meta name="google-site-verification" content="xxxxxxxxxx" />




<meta name="baidu-site-verification" content="xxxxxxxxxx" />







<meta name="keywords" content="Node," />


<meta name="description" content="mocha 是一个功能丰富的javascript测试框架，可以运行在nodejs和浏览器环境，使异步测试变得简单有趣。mocha 串联运行测试，允许灵活和精确地报告结果，同时映射未捕获的异常用来纠正测试用例。
支持TDD/BDD 的 开发方式，结合 should.js/expect/chai/better-assert 断言库，能轻松构建各种风格的测试用例。
断言库Chai 是一个非常灵活的断言库">
<meta property="og:type" content="article">
<meta property="og:title" content="测试利器Mocha">
<meta property="og:url" content="http://yoursite.com/2016/12/07/测试利器Mocha/index.html">
<meta property="og:site_name" content="ChenXing">
<meta property="og:description" content="mocha 是一个功能丰富的javascript测试框架，可以运行在nodejs和浏览器环境，使异步测试变得简单有趣。mocha 串联运行测试，允许灵活和精确地报告结果，同时映射未捕获的异常用来纠正测试用例。
支持TDD/BDD 的 开发方式，结合 should.js/expect/chai/better-assert 断言库，能轻松构建各种风格的测试用例。
断言库Chai 是一个非常灵活的断言库">
<meta property="og:updated_time" content="2017-03-02T13:13:32.031Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="测试利器Mocha">
<meta name="twitter:description" content="mocha 是一个功能丰富的javascript测试框架，可以运行在nodejs和浏览器环境，使异步测试变得简单有趣。mocha 串联运行测试，允许灵活和精确地报告结果，同时映射未捕获的异常用来纠正测试用例。
支持TDD/BDD 的 开发方式，结合 should.js/expect/chai/better-assert 断言库，能轻松构建各种风格的测试用例。
断言库Chai 是一个非常灵活的断言库">






  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.1" />






<link href="http://cdn.bootcss.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.5.1"/>


<script>
(function(){
  var bp = document.createElement('script');
  bp.src = '//push.zhanzhang.baidu.com/push.js';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();
</script>

  <title> 测试利器Mocha </title>
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'xxxxxxxxxx', 'auto');
  ga('send', 'pageview');
</script>



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?1551fdd18711ccb1c048bb11f579b1a4";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



</head>
<body lang="zh-Hans">

  <!--[if lte IE 9]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->


  <div class="another-theme layout">

    
<header class="header" id="header">

  <div class="header-cont">
    <div class="text-area">
      
        <h1 class="title" data-text="测试利器Mocha"> 测试利器Mocha </h1>

        
        <div class="post-meta">
          <div class="post-time">
            发表于
            <time  datetime="2016-12-07T22:53:53+08:00" content="2016-12-07">
              2016-12-07
            </time>
          </div>

          
            <div class="post-category" >
              
                <span>
                  <a href="/categories#Node" itemprop="url" rel="index">
                    <span itemprop="name">Node</span>
                  </a>
                </span>

                
                

              
            </div>
          

          
            
              <span class="post-comments-count">
                <a href="/2016/12/07/测试利器Mocha/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/12/07/测试利器Mocha/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          
        </div>
        
      
    </div>
    <!-- Navigation -->
    
    <nav class="navigation clearfix" id="navigation">
      
        
        <a class="nav-link" href="/" rel="section">
          首页
        </a>
      
        
        <a class="nav-link" href="/tags" rel="section">
          标签
        </a>
      
        
        <a class="nav-link" href="/categories" rel="section">
          分类
        </a>
      
        
        <a class="nav-link" href="/about" rel="section">
          关于
        </a>
      
    </nav>
    
  </div>
  <div class="mask"></div>
</header>


    <main class="container">

      

  <article class="post-article post-type-normal post" itemscope>

  <div class="post-body">

    <div class="content markdown-body"><p>mocha 是一个功能丰富的<em>javascript测试框架</em>，可以运行在nodejs和浏览器环境，使异步测试变得简单有趣。mocha <em>串联运行测试</em>，允许灵活和精确地报告结果，同时映射未捕获的异常用来纠正测试用例。</p>
<p>支持<em>TDD/BDD</em> 的 开发方式，结合 should.js/expect/chai/better-assert <em>断言库</em>，能轻松构建各种风格的<em>测试用例</em>。</p>
<h2 id="断言库"><a href="#断言库" class="headerlink" title="断言库"></a>断言库</h2><p>Chai 是一个非常灵活的断言库，它可以让你使用如下三种主要断言方式的任何一种：</p>
<p><strong>assert：</strong></p>
<p>这是来自老派测试驱动开发的经典的assert方式。比如：</p>
<p><em>assert.equal(variable, “value”);</em></p>
<p><strong>expect：</strong></p>
<p>这种链式的断言方式在行为驱动开发中最为常见。比如：</p>
<p><em>expect(variable).to.equal(“value”);</em></p>
<p><strong>should：</strong></p>
<p>这也是在测试驱动开发中比较常用的方式之一。举例：</p>
<p><em>variable.should.equal(“value”);</em></p>
<h2 id="expect-的语法"><a href="#expect-的语法" class="headerlink" title="expect 的语法"></a>expect 的语法</h2><p>expect 库应用是<em>非常广泛</em>的，它拥有很好的链式结构和仿自然语言的方法。通常写同一个断言会有几个方法，比如expect(response).to.be(true) 和 expect(response).equal(true)。以下列举了 expect 常用的主要方法：</p>
<ul>
<li><strong>ok</strong> ：检查是否为真</li>
<li><strong>true</strong>：检查对象是否为真</li>
<li><strong>to.be、to</strong>：作为连接两个方法的链式方法</li>
<li><strong>not</strong>：链接一个否定的断言，如 expect(false).not.to.be(true)</li>
<li><strong>a/an</strong>：检查类型（也适用于数组类型）</li>
<li><strong>include/contain</strong>：检查数组或字符串是否包含某个元素</li>
<li><strong>below/above</strong>：检查是否大于或者小于某个限定值</li>
</ul>
<h2 id="BDD风格"><a href="#BDD风格" class="headerlink" title="BDD风格"></a>BDD风格</h2><p>mocha “接口” 系统允许开发者选择自身喜爱的特定领域语言风格, mocha 提供 <em>TDD</em>（测试驱动开发）、<em>BDD</em> (行为驱动开发) 和 <em>exports</em> 风格的接口。</p>
<p>BDD是<em>“行为驱动的开发”</em>（Behavior-Driven Development）的简称，指的是写出优秀测试的最佳实践的总称。</p>
<p>BDD认为，不应该针对代码的实现细节写测试，而是要针对行为写测试。BDD测试的是<em>行为</em>，即软件应该怎样运行。</p>
<p>BDD接口提供以下方法：</p>
<ul>
<li><strong>describe()</strong>：测试套件</li>
<li><strong>it()</strong>：测试用例</li>
<li><strong>before()</strong>：所有测试用例的统一前置动作</li>
<li><strong>after()</strong>：所有测试用例的统一后置动作</li>
<li><strong>beforeEach()</strong>：每个测试用例的前置动作</li>
<li><strong>afterEach()</strong>：每个测试用例的后置动作</li>
</ul>
<h2 id="descript-和it"><a href="#descript-和it" class="headerlink" title="descript()和it()"></a>descript()和it()</h2><hr>
<h3 id="descript"><a href="#descript" class="headerlink" title="descript()"></a><strong>descript()</strong></h3><p>describe()方法接收两个参数：第一个参数是一个字符串，表示<em>测试套件</em>的名字或标题，表示将要测试什么。第二个参数是一个函数，用来实现这个<em>测试套件</em>。</p>
<p><strong>上述中引出了一个概念：测试套件。那什么是测试套件呢？</strong></p>
<p>测试套件（test suite）指的是，一组针对软件规格的某个方面的<em>测试用例</em>。也可以看作，对软件的某个方面的描述（describe）。结构如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">"A suite"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;  <span class="comment">// ...&#125;);</span></div></pre></td></tr></table></figure>
<h3 id="it"><a href="#it" class="headerlink" title="it()"></a><strong>it()</strong></h3><p>要想理解it()，首先我们要知道什么是<strong>测试用例</strong>? 测试用例（test case）指的是，针对软件一个功能点的测试，是软件测试的最<em>基本单位</em>。<strong>一组相关的测试用例，构成一个测试套件。</strong></p>
<p>测试用例由it函数构成，它与describe函数一样，接受两个参数：第一个参数是字符串，表示<em>测试用例的标题</em>；第二个参数是函数，用来实现这个<em>测试用例</em>。</p>
<h3 id="BDD风格用例"><a href="#BDD风格用例" class="headerlink" title="BDD风格用例"></a><strong>BDD风格用例</strong></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> expect = <span class="built_in">require</span>(<span class="string">'chai'</span>).expect;</div><div class="line"> </div><div class="line">describe(<span class="string">'Array'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  before(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'在测试之前运行'</span>);</div><div class="line">  &#125;);</div><div class="line"> </div><div class="line">  describe(<span class="string">'#indexOf()'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    it(<span class="string">'当值不存在时应该返回 -1'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      expect([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].indexOf(<span class="number">4</span>)).to.equal(<span class="number">-1</span>);</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="TDD风格"><a href="#TDD风格" class="headerlink" title="TDD风格"></a>TDD风格</h2><p>TDD（测试驱动开发）组织方式是使用<em>测试集（suite）和测试（test）</em>。</p>
<p>每个测试集都有<em> setup 和 teardown 函数</em>。这些方法会在测试集中的测试执行前执行，它们的作用是为了避免代码重复以及最大限度使得测试之间相互独立。</p>
<p>TDD接口：</p>
<ul>
<li><strong>suite</strong>：类似BDD中 describe()</li>
<li><strong>test</strong>：类似BDD中 it()</li>
<li><strong>setup</strong>：类似BDD中 before()</li>
<li><strong>teardown</strong>：类似BDD中 after()</li>
<li><strong>suiteSetup</strong>：类似BDD中 beforeEach()</li>
<li><strong>suiteTeardown</strong>：类似BDD中 afterEach()</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> assert = <span class="built_in">require</span>(<span class="string">"assert"</span>);</div><div class="line"> </div><div class="line">suite(<span class="string">'Array'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  setup(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'测试执行前执行'</span>);</div><div class="line">  &#125;);</div><div class="line"> </div><div class="line">  suite(<span class="string">'#indexOf()'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    test(<span class="string">'当值不存在时应该返回 -1'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      assert.equal(<span class="number">-1</span>, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].indexOf(<span class="number">4</span>));</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>运行mocha：</p>
<p><em>mocha –ui tdd \</em>.js<em> (</em>表示的是文件名)</p>
<h2 id="exports"><a href="#exports" class="headerlink" title="exports"></a>exports</h2><p>exports类似于nodejs里的<em>模块语法</em>,关键字 before, after, beforeEach, 和 afterEach 是特殊保留的，值为对象时是一个<em>测试套件</em>，为函数时则是一个<em>测试用例</em>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">before</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;,</div><div class="line"> </div><div class="line">  <span class="string">'Array'</span>: &#123;</div><div class="line">     <span class="string">'#indexOf()'</span>: &#123;</div><div class="line">        <span class="string">'当值不存在时应该返回 -1'</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">          expect([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].indexOf(<span class="number">4</span>)).to.equal(<span class="number">-1</span>);</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p><strong>运行 mocha</strong></p>
<p><em>mocha –ui exports \</em>.js*</p>
<h2 id="hook-机制"><a href="#hook-机制" class="headerlink" title="hook 机制"></a>hook 机制</h2><p>hook 就是在测试流程的不同时段触发，比如在整个测试流程之前，或在每个独立测试之前等。</p>
<p>hook也可以理解为是一些逻辑，通常表现为一个函数或者一些声明，当特定的事件触发时 hook 才执行。</p>
<p>提供方法有：before()、beforeEach() after() 和 afterEach()。</p>
<p><strong>方法解析</strong>：</p>
<ul>
<li><strong>before()</strong>：所有测试用例的统一前置动作</li>
<li><strong>after()</strong>：所有测试用例的统一后置动作</li>
<li><strong>beforeEach()</strong>：每个测试用例的前置动作</li>
<li><strong>afterEach()</strong>：每个测试用例的后置动作</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'hooks'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  before(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//在执行本区块的所有测试之前执行</span></div><div class="line">  &#125;);</div><div class="line"> </div><div class="line">  after(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//在执行本区块的所有测试之后执行</span></div><div class="line">  &#125;);</div><div class="line"> </div><div class="line">  beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//在执行本区块的每个测试之前都执行</span></div><div class="line">  &#125;);</div><div class="line"> </div><div class="line">  afterEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//在执行本区块的每个测试之后都执行</span></div><div class="line">  &#125;);</div><div class="line"> </div><div class="line">  <span class="comment">//测试用例</span></div><div class="line"> </div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="描述-hook"><a href="#描述-hook" class="headerlink" title="描述 hook"></a>描述 hook</h2><p>所有的 <em>hook</em> 都可以加上描述，这样可以更好地定位到测试用例中的错误。如果<em> hook </em>函数指定了名称，会在没有描述时使用函数名，例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">//beforeEach hook</span></div><div class="line">&#125;);</div><div class="line"> </div><div class="line">beforeEach(<span class="function"><span class="keyword">function</span> <span class="title">needFun</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">//beforeEach: namedFun</span></div><div class="line">&#125;);</div><div class="line"> </div><div class="line">beforeEach(<span class="string">'some description'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">//beforeEach:some description</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><strong>补充</strong>：上述示例中 注释的内容就是对 hook 的描述。</p>
<h2 id="测试占位"><a href="#测试占位" class="headerlink" title="测试占位"></a>测试占位</h2><p>测试用例占位只要添加一个没有回调的 it() 方法即可：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> assert = <span class="built_in">require</span>(<span class="string">'assert'</span>);</div><div class="line"> </div><div class="line">describe(<span class="string">'Array'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line"> </div><div class="line">  describe(<span class="string">'#indexOf()'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">//同步测试</span></div><div class="line">    it(<span class="string">'当值不存在时应该返回 -1'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      assert.equal(<span class="number">-1</span>, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].indexOf(<span class="number">5</span>));</div><div class="line">      assert.equal(<span class="number">-1</span>, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].indexOf(<span class="number">0</span>));</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line"> </div><div class="line">  describe(<span class="string">'Array'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    describe(<span class="string">'#indexOf()'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="comment">//下面是一个挂起的测试</span></div><div class="line">      it(<span class="string">'当值不存在时应该返回 -1'</span>);</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="仅执行指定测试"><a href="#仅执行指定测试" class="headerlink" title="仅执行指定测试"></a>仅执行指定测试</h2><p>仅执行指定测试的特性可以让你通过添加 .only() 来指定唯一要执行的测试套件或测试用例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'Array'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  describe.only(<span class="string">'#indexOf()'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    ...</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>或一个指定的测试用例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'Array'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  describe(<span class="string">'#indexOf()'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    it.only(<span class="string">'当值不存在时应该返回 -1'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"> </div><div class="line">    &#125;)</div><div class="line"> </div><div class="line">    it(<span class="string">'当值不存在时应该返回 -1'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"> </div><div class="line">    &#125;)</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>PS:注意只能出现一个 .only()</p>
<h2 id="忽略指定测试"><a href="#忽略指定测试" class="headerlink" title="忽略指定测试"></a>忽略指定测试</h2><p>该特性和 .only() 非常相似，通过添加 .skip() 你可以告诉 Mocha 忽略的测试套件或者测试用例（可以有多个）。该操作使得这些操作处于挂起的状态，这比使用注释来的要好，因为你可能会忘记把注释给取消掉。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'Array'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  describe.skip(<span class="string">'#indexOf()'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    ...</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>或一个指定的测试用例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">describe(<span class="string">'Array'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  describe(<span class="string">'#indexOf()'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    it.skip(<span class="string">'当值不存在时应该返回 -1'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"> </div><div class="line">    &#125;)</div><div class="line"> </div><div class="line">    it(<span class="string">'当值不存在时应该返回 -1'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"> </div><div class="line">    &#125;)</div><div class="line">  &#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="动态生成测试"><a href="#动态生成测试" class="headerlink" title="动态生成测试"></a>动态生成测试</h2><p>由于mocha 可以使用 function.prototype.call 和function 表达式<em>定义测试套件和测试用例</em>，所以可以动态生成测试用例。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> assert = <span class="built_in">require</span>(<span class="string">'assert'</span>);</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>).reduce(<span class="function"><span class="keyword">function</span>(<span class="params">prev, curr</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> prev + curr;</div><div class="line">  &#125;, <span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"> </div><div class="line">describe(<span class="string">'add()'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> tests = [</div><div class="line">    &#123;<span class="attr">args</span>: [<span class="number">1</span>, <span class="number">2</span>],       <span class="attr">expected</span>: <span class="number">3</span>&#125;,</div><div class="line">    &#123;<span class="attr">args</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],    <span class="attr">expected</span>: <span class="number">6</span>&#125;,</div><div class="line">    &#123;<span class="attr">args</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="attr">expected</span>: <span class="number">10</span>&#125;</div><div class="line">  ];</div><div class="line"> </div><div class="line">  tests.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">test</span>) </span>&#123;</div><div class="line">    it(<span class="string">'correctly adds '</span> + test.args.length + <span class="string">' args'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">var</span> res = add.apply(<span class="literal">null</span>, test.args);</div><div class="line">      assert.equal(res, test.expected);</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="小小测试"><a href="#小小测试" class="headerlink" title="小小测试"></a>小小测试</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>),</div><div class="line">    PORT = <span class="number">3000</span>;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">onRequest</span>(<span class="params">request, response</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"Request received."</span>);</div><div class="line">    response.writeHead(<span class="number">200</span>, &#123;<span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span>&#125;);</div><div class="line">    response.write(<span class="string">"Hello World"</span>);</div><div class="line">    response.end();</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="keyword">var</span> server = http.createServer(onRequest);</div><div class="line"></div><div class="line"><span class="keyword">var</span> boot = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    server.listen(PORT, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.info(<span class="string">'Express server listening on port '</span> + PORT);</div><div class="line">    &#125;);</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> shutdown = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    server.close();</div><div class="line">&#125;;</div><div class="line"><span class="keyword">if</span> (<span class="built_in">require</span>.main === <span class="built_in">module</span>) &#123;</div><div class="line">    boot();</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="built_in">console</span>.info(<span class="string">'Running app as a module'</span>);</div><div class="line">    exports.boot = boot;</div><div class="line">    exports.shutdown = shutdown;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> boot = <span class="built_in">require</span>(<span class="string">'./app'</span>).boot,</div><div class="line">    shutdown = <span class="built_in">require</span>(<span class="string">'./app'</span>).shutdown,</div><div class="line">    request = <span class="built_in">require</span>(<span class="string">'superagent'</span>),</div><div class="line">    expect = <span class="built_in">require</span>(<span class="string">'chai'</span>).expect;</div><div class="line"> </div><div class="line">describe(<span class="string">'server'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    before(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        boot();</div><div class="line">    &#125;);</div><div class="line">    describe(<span class="string">'index'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        it(<span class="string">'should respond to GET'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">done</span>) </span>&#123;</div><div class="line">            request</div><div class="line">                .get(<span class="string">'http://localhost:3000'</span>)</div><div class="line">                .end(<span class="function"><span class="keyword">function</span> (<span class="params">err, res</span>) </span>&#123;</div><div class="line">                    expect(res.status).to.equal(<span class="number">200</span>);</div><div class="line">                    done();</div><div class="line">                &#125;);</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div><div class="line">    after(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        shutdown();</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</div>

    <div class="post-sidebar">
  <div class="toggle-btn" id="toggle-btn">
    <i class="fa fa-reorder"></i>
  </div>
  <section class="post-toc-wrap" id="post-sidebar">
    <h2 class="toc-title">内容目录</h2>
    <div class="post-toc">
      
      
        <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#断言库"><span class="nav-text">断言库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#expect-的语法"><span class="nav-text">expect 的语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BDD风格"><span class="nav-text">BDD风格</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#descript-和it"><span class="nav-text">descript()和it()</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#descript"><span class="nav-text">descript()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#it"><span class="nav-text">it()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BDD风格用例"><span class="nav-text">BDD风格用例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TDD风格"><span class="nav-text">TDD风格</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#exports"><span class="nav-text">exports</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hook-机制"><span class="nav-text">hook 机制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#描述-hook"><span class="nav-text">描述 hook</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#测试占位"><span class="nav-text">测试占位</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#仅执行指定测试"><span class="nav-text">仅执行指定测试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#忽略指定测试"><span class="nav-text">忽略指定测试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#动态生成测试"><span class="nav-text">动态生成测试</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#小小测试"><span class="nav-text">小小测试</span></a></li></ol></div>
      
    </div>
  </section>
</div>


  </div>

  <footer class="post-footer">
    
      <div class="post-tags">
        
          <a href="/tags#Node" rel="tag">#Node</a>
        
      </div>
    
    

  </footer>

</article>




      
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/12/07/测试利器Mocha/"
           data-title="测试利器Mocha" data-url="http://yoursite.com/2016/12/07/测试利器Mocha/">
      </div>
    
  </div>




    </main>

    <footer class="footer clearfix">
  <div class="copyright" >
    <span>Copyright</span>
    
    &copy; 
    <span itemprop="copyrightYear">2017</span>
    <span class="author" itemprop="copyrightHolder">ChenXing</span>
  </div>

  <div class="info">
    <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <span id="busuanzi_container_site_pv">
        总访问量<span id="busuanzi_value_site_pv"></span>次
    </span>
  </div>

</footer>


  </div>

  <div class="back-top-btn" id="back-top-btn"><i class="fa fa-chevron-up"></i></div>





  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"xxxxxxxxxx"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>
    
     






<script type="text/javascript" src="/js/motto.min.js?v=0.4.5.1"></script>
<script type="text/javascript" src="/js/main.js?v=0.4.5.1"></script>


</body>
</html>
